# ü™ü –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è Windows - –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ

## ‚úÖ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ MediaInfo –Ω–∞ Windows
**–ü—Ä–æ–±–ª–µ–º–∞**: `sudo apt install mediainfo` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—É—Ç–µ–π –ø–æ–∏—Å–∫–∞ MediaInfo
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Windows
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –≤ –ø–∞–ø–∫–µ `tools/`
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —á–µ—Ä–µ–∑ Chocolatey, Scoop –∏ —Ä—É—á–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É

**–ü—É—Ç–∏ –ø–æ–∏—Å–∫–∞ MediaInfo**:
```
mediainfo.exe
C:\Program Files\MediaInfo\mediainfo.exe
C:\Program Files (x86)\MediaInfo\mediainfo.exe
tools\mediainfo.exe (–ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è)
```

### 2. TMDB API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù—É–∂–Ω–æ –±—ã–ª–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `tmdbApiKey` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–≤–æ–¥–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ API –∫–ª—é—á–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ TMDB API

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- –í–≤–æ–¥ API –∫–ª—é—á–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á" –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ/–ø–æ–∫–∞–∑ –∫–ª—é—á–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 3. –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù—É–∂–Ω–æ –±—ã–ª–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –∫–∞–∂–¥–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ**:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ MediaInfo
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –†–∞–±–æ—Ç–∞ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –±–µ–∑ MediaInfo

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### SettingsModel.js
```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ –¥–ª—è TMDB API –∫–ª—é—á–∞
this.defaultConfig = {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  tmdbApiKey: process.env.TMDB_API_KEY || '' // API –∫–ª—é—á –¥–ª—è TMDB
};
```

### TMDBService.js
```javascript
// –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
getApiKey() {
  const settings = Settings.readConfig();
  return settings.tmdbApiKey || process.env.TMDB_API_KEY || '';
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
isApiAvailable() {
  return !!this.getApiKey();
}
```

### MediaInfoService.js
```javascript
// –ü–æ–∏—Å–∫ MediaInfo –≤ —Å–∏—Å—Ç–µ–º–µ
async findMediaInfo() {
  const possiblePaths = [
    // Windows –ø—É—Ç–∏
    'mediainfo.exe',
    'C:\\Program Files\\MediaInfo\\mediainfo.exe',
    path.join(process.cwd(), 'tools', 'mediainfo.exe'),
    // Linux/macOS –ø—É—Ç–∏
    'mediainfo',
    '/usr/bin/mediainfo'
  ];
  // ... –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø—É—Ç—è–º
}
```

### SmartFileProcessor.js
```javascript
// –†–∞–±–æ—Ç–∞ –±–µ–∑ MediaInfo
if (!mediaInfo) {
  // –ï—Å–ª–∏ MediaInfo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ª—É—á–∞–µ–º –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
  const basicInfo = await MediaInfoService.getBasicFileInfo(filePath);
  if (basicInfo) {
    result.mediaInfo = basicInfo;
    result.quality = this.guessQualityFromFileName(fileName);
  }
}

// –£–≥–∞–¥—ã–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
guessQualityFromFileName(fileName) {
  const lowerName = fileName.toLowerCase();
  if (lowerName.includes('4k')) return '4K';
  if (lowerName.includes('1080p')) return '1080p';
  // ...
}
```

## üì± –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (settings.ejs)
```html
<!-- –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è TMDB API -->
<div class="card rounded-4">
  <div class="card-body">
    <h2 class="h5 mb-3">–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤</h2>
    <form id="tmdbSettingsForm" class="d-grid gap-3">
      <div>
        <label class="form-label">TMDB API –∫–ª—é—á</label>
        <div class="input-group">
          <input type="password" id="tmdbApiKey" class="form-control rounded-4">
          <button class="btn btn-outline-secondary rounded-4" type="button" id="toggleTmdbKey">–ü–æ–∫–∞–∑–∞—Ç—å</button>
        </div>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-primary rounded-4" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn btn-outline-info rounded-4" type="button" id="testTmdbBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á</button>
      </div>
    </form>
  </div>
</div>
```

### –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (smart-files.ejs)
```javascript
// –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
async function checkSystemStatus() {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ MediaInfo
  const mediainfoData = await fetch('/api/smart/check-mediainfo').then(r => r.json());
  mediainfoStatus.className = `badge ${mediainfoData.available ? 'bg-success' : 'bg-warning'}`;
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ TMDB API
  const tmdbData = await fetch('/api/smart/check-tmdb').then(r => r.json());
  tmdbStatus.className = `badge ${tmdbData.available ? 'bg-success' : 'bg-warning'}`;
}
```

## üîß –ù–æ–≤—ã–µ API endpoints

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ TMDB API
GET /api/smart/check-tmdb

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å TMDB –∫–ª—é—á–æ–º
PATCH /api/settings
{
  "tmdbApiKey": "your_api_key_here"
}
```

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –î–ª—è Windows:
1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ MediaInfo**:
   ```powershell
   choco install mediainfo
   ```
   –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å —Å https://mediaarea.net/en/MediaInfo/Download/Windows

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ TMDB API**:
   - –û—Ç–∫—Ä—ã—Ç—å "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   - –ù–∞–π—Ç–∏ "–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤"
   - –í–≤–µ—Å—Ç–∏ API –∫–ª—é—á
   - –ù–∞–∂–∞—Ç—å "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á"

3. **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è**:
   - –ü–æ–º–µ—Å—Ç–∏—Ç—å `mediainfo.exe` –≤ –ø–∞–ø–∫—É `tools/`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API –∫–ª—é—á –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é –ø–∞–ø–∫—É –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä

### –î–ª—è Linux/macOS:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚ùå –ù—É–∂–Ω–æ –±—ã–ª–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å MediaInfo –≤—Ä—É—á–Ω—É—é
- ‚ùå –¢—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚ùå –ù–µ –±—ã–ª–æ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚ùå –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Windows

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ MediaInfo
- ‚úÖ –£–¥–æ–±–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –†–∞–±–æ—Ç–∞ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –±–µ–∑ MediaInfo
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Windows
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ Windows:
- **–ü—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** MediaInfo —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤
- **–£–¥–æ–±–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** TMDB API —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ MediaInfo
- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ  
**–î–∞—Ç–∞**: –ê–≤–≥—É—Å—Ç 2024