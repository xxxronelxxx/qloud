<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%- title %></title>
    <script>
      (function(){
        try {
          var th = localStorage.getItem('qloud_theme') || 'light';
          document.documentElement.setAttribute('data-theme', th);
          document.documentElement.setAttribute('data-bs-theme', th);
        } catch(e) {}
      })();
    </script>

    <link rel="stylesheet" href="assets/styles/bootstrap.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="assets/styles/bootstrap-icons.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="assets/styles/aos.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="assets/styles/custom.css" media="print" onload="this.media='all'">

    <noscript>
        <link rel="stylesheet" href="assets/styles/bootstrap.min.css">
        <link rel="stylesheet" href="assets/styles/bootstrap-icons.min.css">
        <link rel="stylesheet" href="assets/styles/aos.css">
        <link rel="stylesheet" href="assets/styles/custom.css">
    </noscript>

</head>

<body class="px-2 px-xxl-0" style="opacity:0" id="app">
    <%-include("modules/search-modal.ejs") %>
    <%- include("modal/show-connect") %>
    <%- include("modal/preview-image") %>
    <%- body %>

    <!-- Bootstrap загружается синхронно для корректной работы модальных окон -->
    <script src="assets/scripts/bootstrap.bundle.min.js"></script>
    <script src="assets/scripts/aos.js" defer></script>
    <script src="assets/scripts/qrcode.js" defer></script>
    <script type="module">
        document.addEventListener("DOMContentLoaded", async () => {
            document.body.classList.add('loaded');
            AOS.init();

            try {
              const res = await fetch('/api/settings');
              const { config } = await res.json();
              const theme = (config && config.theme) || 'light';
              document.documentElement.setAttribute('data-theme', theme);
              document.documentElement.setAttribute('data-bs-theme', theme);
              try { localStorage.setItem('qloud_theme', theme); } catch(e) {}
            } catch (_) {}
        });
    </script>

</body>

</html>